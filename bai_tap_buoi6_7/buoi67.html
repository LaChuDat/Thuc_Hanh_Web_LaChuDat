<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CRUD Responsive</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
  <link rel="stylesheet" href="style.css" />
  <style>
    #thongBao {
      color: rgb(128, 124, 0);
      font-weight: bold;
      margin-bottom: 1rem;
      min-height: 1.2em;
    }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">Quản lý sinh viên</a>
    </div>
  </nav>

  <div class="container">
    <div class="row g-4">
      <div class="col-12 col-md-6">
        <div class="section-title">Thêm / Cập nhật Sinh Viên</div>
        <div id="thongBao"></div>

        <form id="studentForm">
          <div class="mb-3">
            <label for="studentId" class="form-label">Mã sinh viên *</label>
            <input type="text" class="form-control" id="studentId" required pattern="[A-Za-z0-9]{2,10}">
          </div>
          <div class="mb-3">
            <label for="fullName" class="form-label">Họ và tên *</label>
            <input type="text" class="form-control" id="fullName" required>
          </div>
          <div class="mb-3">
            <label for="email" class="form-label">Email *</label>
            <input type="email" class="form-control" id="email" required>
          </div>
          <div class="mb-3">
            <label for="dob" class="form-label">Ngày sinh *</label>
            <input type="date" class="form-control" id="dob" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Giới tính *</label><br />
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="gender" id="male" value="Nam" required>
              <label class="form-check-label" for="male">Nam</label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="gender" id="female" value="Nữ">
              <label class="form-check-label" for="female">Nữ</label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="gender" id="other" value="Khác">
              <label class="form-check-label" for="other">Khác</label>
            </div>
          </div>
          <div class="mb-3">
            <label for="notes" class="form-label">Ghi chú</label>
            <textarea class="form-control" id="notes" rows="3"></textarea>
          </div>
          <button type="submit" class="btn btn-success" id="btnThem">Thêm Sinh Viên</button>
        </form>
      </div>
      <div class="col-12 col-md-6">
        <div class="section-title">Danh sách Sinh Viên</div>
        <div class="table-responsive">
          <table class="table table-bordered table-hover">
            <thead>
              <tr>
                <th>STT</th>
                <th>Mã SV</th>
                <th>Họ tên</th>
                <th>Email</th>
                <th>Giới tính</th>
                <th>Ngày sinh</th>
                <th>Hành động</th>
              </tr>
            </thead>
            <tbody id="bangSinhVien">
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <script>
    const form      = document.getElementById('studentForm');
    const tableBody = document.getElementById('bangSinhVien');
    const thongBao  = document.getElementById('thongBao');
    const btnThem   = document.getElementById('btnThem');

    let stt = 1;
    let selectedRow = null;
    btnThem.addEventListener('click', function(e) {
      alert('Đã nhấn nút Thêm Sinh Viên');
    });
    form.addEventListener('submit', function(e) {
      e.preventDefault();
      const maSV   = document.getElementById('studentId').value.trim();
      const hoTen  = document.getElementById('fullName').value.trim();
      const email  = document.getElementById('email').value.trim();
      const dob    = document.getElementById('dob').value;
      const gender = document.querySelector('input[name="gender"]:checked')?.value;
      if (!maSV || !hoTen || !email || !dob || !gender) {
        alert('Vui lòng điền đầy đủ thông tin.');
        return;
      }
      const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!regex.test(email)) {
        alert('Email không hợp lệ.');
        return;
      }

      if (selectedRow) {
        selectedRow.cells[1].innerText = maSV;
        selectedRow.cells[2].innerText = hoTen;
        selectedRow.cells[3].innerText = email;
        selectedRow.cells[4].innerText = gender;
        selectedRow.cells[5].innerText = dob;
        showMessage('Cập nhật thành công!');
        btnThem.innerText = 'Thêm Sinh Viên';
        selectedRow = null;
      } else {
        const row = tableBody.insertRow();
        row.insertCell(0).innerText = stt++;
        row.insertCell(1).innerText = maSV;
        row.insertCell(2).innerText = hoTen;
        row.insertCell(3).innerText = email;
        row.insertCell(4).innerText = gender;
        row.insertCell(5).innerText = dob;
        row.insertCell(6).innerHTML =
          '<button class="btn btn-warning btn-sm me-1" onclick="editRow(this)">Sửa</button>' +
          '<button class="btn btn-danger btn-sm" onclick="deleteRow(this)">Xóa</button>';
        showMessage('Thêm sinh viên thành công!');
      }
      form.reset();
    });
    function showMessage(msg) {
      thongBao.innerText = msg;
      setTimeout(() => { thongBao.innerText = ''; }, 3000);
    }
    function deleteRow(btn) {
      if (confirm('Bạn có chắc chắn muốn xóa?')) {
        btn.parentElement.parentElement.remove();
        showMessage('Xóa thành công!');
      }
    }
    function editRow(btn) {
      selectedRow = btn.parentElement.parentElement;
      document.getElementById('studentId').value = selectedRow.cells[1].innerText;
      document.getElementById('fullName').value   = selectedRow.cells[2].innerText;
      document.getElementById('email').value      = selectedRow.cells[3].innerText;
      document.getElementById('dob').value        = selectedRow.cells[5].innerText;
      document.querySelector(`input[name="gender"][value="${selectedRow.cells[4].innerText}"]`).checked = true;
      btnThem.innerText = 'Cập nhật';
    }
  </script>
</body>
</html>
